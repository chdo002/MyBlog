---
title: 其他
date: 2018-04-16 11:41:16
tags:
---

## iTunes 提交没有版本
### 2018-04-16 11:41:16

提交到iTunes connect 上看不到版本，可能是某些隐私权限你用到了，但是没有在info.plist中说明，比如说蓝牙，这也不会导致测试环境下的崩溃，但生产下就不行了


## GCD的线程数目

GCD会维护一个线程池，而线程池中的线程数目是有上限的，具体数字在64位系统上是64，32位系统还没有机会测试

具体的影响，如下代码

```
- (void)viewDidLoad {
    [super viewDidLoad];
    
    dispatch_queue_t quq = dispatch_queue_create("affa", DISPATCH_QUEUE_CONCURRENT);
    int taskAmount = 64;
    for (int i = 0; i<taskAmount; i++) {
        dispatch_async(quq, ^{
            sleep(2);
            NSLog(@"--%@",[NSThread currentThread]);
        });
    }
}
```

直觉上，因为用了dispatch_async，所以应该不会卡主线程，实际上，因为dispatch_async用光了64条线程，其中包含了主线程，所以界面就会卡2秒。

更进一步，如果这里的taskAmount是64的n(n>=1，n为正整数)倍，那么卡顿时间也会变成2*n秒时间。

这种情况下就需要手动的控制并发数量，其实用NSOperationqueue就可以直接的控制，GCD的话没有直接设置的方法，只能用信号量达到类似效果

```
dispatch_queue_t workConcurrentQueue = dispatch_queue_create("workQueue", DISPATCH_QUEUE_CONCURRENT);
    dispatch_queue_t serialQueue = dispatch_queue_create("controllQueue",DISPATCH_QUEUE_SERIAL);
    dispatch_semaphore_t semaphore = dispatch_semaphore_create(4);    // create semaphore: value = 3

    dispatch_group_t group = dispatch_group_create();
    
    NSLog(@"begin: %@",[NSThread currentThread]);
    
    for (int i = 0; i < 10; i++) {
        __block int index = i;
        
			dispatch_group_async(group, serialQueue, ^{
            // If value < 0, then wait here. Else value > 0, then pass, and value -1
            dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);
            dispatch_group_async(group, workConcurrentQueue, ^{
                sleep(1);
                NSLog(@"执行第%d次操作，线程：%@",index, [NSThread currentThread]);
                dispatch_semaphore_signal(semaphore);                // Perform value +1
            });
        });
    }
    
    dispatch_group_notify(group, workConcurrentQueue, ^{
        NSLog(@"okk");
    });
```



## 泛型实例化
OC中的泛型是所谓的轻量化泛型，暂时还不知道怎么实现泛型实例化，swift中的实现记录在下面
```

func testFunc<T: NSObject>(cls:T) -> T {
    let obj = T()
    return obj
}

testFunc(cls: NSString())

```


## extern static const
https://www.jianshu.com/p/2fd58ed2cf55
https://www.jianshu.com/p/3fa703e80720


## cocoapods
https://www.jianshu.com/p/89605e02bf18
